<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags - Optimized for Open Redirect Tester -->
    <title>Advanced Open Redirect Tester | WAF Bypass Payloads</title>
    <meta name="description" content="An intelligent, professional tool to test for open redirect vulnerabilities (CWE-601). Generates a comprehensive list of modern, WAF-bypass payloads. Essential for bug bounty hunters and pentesters.">
    <meta name="keywords" content="open redirect tester, open redirect payloads, waf bypass, bulk open redirect scanner, url redirect checker, url redirection vulnerability, CWE-601, bug bounty, pentesting tool, security scanner">
    <meta name="author" content="Switchere Club">
    <link rel="canonical" href="https://www.switchere.online/">

    <!-- Open Graph Meta Tags for Social Sharing -->
    <meta property="og:title" content="Advanced Open Redirect Tester | WAF Bypass Payloads">
    <meta property="og:description" content="Test any URL for open redirect vulnerabilities with our free, instant scanner. Generates a comprehensive list of basic and advanced WAF bypass payloads. A must-have tool for security professionals.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.switchere.online/">
    <meta property="og:image" content="https://www.switchere.online/og-image-redirect.jpg">
    <meta property="og:site_name" content="Security Analysis Hub">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Advanced Open Redirect Tester | WAF Bypass Payloads">
    <meta name="twitter:description" content="Test any URL for open redirect vulnerabilities with our free, instant scanner. Generates a comprehensive list of basic and advanced WAF bypass payloads. A must-have tool for security professionals.">

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230066CC' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6'%3E%3C/path%3E%3Cpolyline points='15 3 21 3 21 9'%3E%3C/polyline%3E%3Cline x1='10' y1='14' x2='21' y2='3'%3E%3C/line%3E%3C/svg%3E">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React and Babel for JSX -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Schema.org Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Open Redirect Tester",
        "description": "A free, secure tool to test for open redirect vulnerabilities (CWE-601) by generating common payloads and simulating the redirect safely.",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Any",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
        "aggregateRating": { "@type": "AggregateRating", "ratingValue": "4.9", "ratingCount": "915" }
    }
    </script>

    <!-- Core Styles -->
    <style>
        :root {
            --primary: #0066CC; --primary-light: #E6F2FF; --primary-dark: #004C99;
            --accent: #00CC88; --accent-light: #E6FFF9; --text-dark: #1A1A1A;
            --text-gray: #4A5568; --text-light: #718096; --border: #E2E8F0;
            --bg-white: #FFFFFF; --bg-light: #F7FAFC;
            --dark-bg: #111827; --dark-card: #1f2937; --dark-border: #374151;
            --dark-text: #d1d5db; --dark-text-gray: #9ca3af;
            --font-mono: 'Source Code Pro', monospace;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', sans-serif; background: var(--bg-light); color: var(--text-dark); 
            line-height: 1.65; font-size: 16px; -webkit-font-smoothing: antialiased;
            transition: background-color 0.4s ease, color 0.4s ease;
        }
        html.dark body { background: var(--dark-bg); color: var(--dark-text); }
        
        header { 
            background: rgba(255,255,255,0.8); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border); box-shadow: 0 1px 3px rgba(0,0,0,0.05); 
            position: sticky; top: 0; z-index: 50;
            transition: background-color 0.4s ease, border-color 0.4s ease;
        }
        html.dark header { background: rgba(31, 41, 55, 0.8); border-bottom-color: var(--dark-border); }

        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        .logo { color: var(--primary); font-weight: 700; font-size: 1.125rem; letter-spacing: -0.02em; }
        nav a { color: var(--text-gray); text-decoration: none; font-size: 0.9375rem; transition: color 0.2s; font-weight: 500; }
        html.dark nav a { color: var(--dark-text-gray); }
        nav a:hover { color: var(--primary); }
        
        .hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); padding: 5rem 1rem 4.5rem; text-align: center; }
        .hero h1 { font-size: clamp(2rem, 5vw, 3rem); font-weight: 800; margin-bottom: 1rem; color: white; letter-spacing: -0.03em; line-height: 1.2; }
        .hero p { color: rgba(255,255,255,0.95); font-size: clamp(1rem, 3vw, 1.125rem); line-height: 1.6; max-width: 700px; margin: 0 auto 1.5rem; }
        
        .btn { padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; border: none; font-size: 0.95rem; text-decoration: none; display: inline-block; }
        .btn-primary { background: var(--accent); color: white; box-shadow: 0 4px 14px rgba(0,204,136,0.25); }
        .btn-primary:hover { background: #00a36e; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,204,136,0.3); }
        
        .card { background: var(--bg-white); border-radius: 12px; padding: 2rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid var(--border); margin-bottom: 1.5rem; transition: all 0.4s ease; }
        html.dark .card { background: var(--dark-card); border-color: var(--dark-border); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); border-color: var(--primary); }
        html.dark .card-hover:hover { box-shadow: 0 8px 20px rgba(0,0,0,0.2); }
        
        section { padding: 4rem 1rem; }
        #tester, #how-to-guide { background: var(--bg-light); transition: background-color 0.4s ease; }
        html.dark #tester, html.dark #how-to-guide { background: #1f293770; }
        .section-title { font-size: clamp(1.75rem, 4vw, 2.25rem); font-weight: 700; text-align: center; margin-bottom: 1rem; letter-spacing: -0.02em; line-height: 1.3; }
        .section-desc { text-align: center; color: var(--text-gray); margin-bottom: 2.5rem; max-width: 650px; margin-left: auto; margin-right: auto; font-size: clamp(0.9rem, 2vw, 1.0625rem); line-height: 1.6; }
        html.dark .section-desc { color: var(--dark-text-gray); }

        #faq { background: var(--bg-light); transition: background-color 0.4s ease; }
        html.dark #faq { background: var(--dark-bg); }
        
        .faq-item { border-bottom: 1px solid var(--border); transition: all 0.2s ease; }
        html.dark .faq-item { border-color: var(--dark-border); }
        .faq-item:last-child { border-bottom: none; }
        .faq-question { padding: 1.25rem 0.5rem; font-weight: 600; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .faq-answer { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out, padding-bottom 0.4s ease-out; }
        .faq-answer p { padding-bottom: 1.25rem; padding-left: 0.5rem; color: var(--text-gray); }
        html.dark .faq-answer p { color: var(--dark-text-gray); }
        .faq-answer.active { max-height: 200px; }
        .faq-icon { transition: transform 0.3s; color: var(--primary); }
        .faq-icon.active { transform: rotate(180deg); }
        
        footer { background: var(--text-dark); color: rgba(255,255,255,0.8); padding: 3rem 1rem; font-size: 0.85rem; }
        footer a { color: rgba(255,255,255,0.8); text-decoration: none; transition: all 0.2s; }
        footer a:hover { color: var(--primary); }

        .fade-in { animation: fadeInAnimation 0.6s cubic-bezier(0.215, 0.610, 0.355, 1.000) forwards; }
        @keyframes fadeInAnimation { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .spinner { animation: spin 1s linear infinite; }
    </style>
</head>
<body>
<header>
    <div class="container">
        <div class="flex justify-between items-center py-3.5">
            <a href="#" class="flex items-center gap-2 no-underline">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-[var(--primary)]"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                <span class="logo">Open Redirect Tester</span>
            </a>
            <nav class="hidden md:flex gap-5 items-center">
                <a href="#tester">Tester</a>
                <a href="#why-test">Why Test?</a>
                <a href="#faq">FAQ</a>
                <a href="https://www.switchere.online/tools" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-sm font-semibold text-white bg-[var(--primary)] hover:bg-[var(--primary-dark)] px-4 py-2 rounded-lg transition-all duration-200 transform hover:-translate-y-0.5 shadow-lg hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[var(--primary)] dark:focus:ring-offset-[var(--dark-bg)]">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z"/></svg>
                    <span>All Tools</span>
                </a>
            </nav>
        </div>
    </div>
</header>
<section class="hero">
    <h1>Find Open Redirect Vulnerabilities</h1>
    <p class="seo-copy">A simple, powerful tool for security researchers and developers to test for open redirect vulnerabilities. Generate payloads and run safe simulations instantly.</p>
    <a href="#tester" class="btn btn-primary">Start Testing Now</a>
</section>
<section id="tester">
    <div class="container">
        <div class="text-center mb-8">
            <div class="inline-block bg-[var(--primary-light)] text-[var(--primary)] py-2 px-4 rounded-full text-sm font-semibold mb-4">SECURITY SCANNING TOOL</div>
        </div>
        <div id="root"></div>
    </div>
</section>
<section id="why-test">
    <div class="container">
        <h2 class="section-title">Why Test for Open Redirects?</h2>
        <p class="section-desc seo-copy">An open redirect is a common but serious vulnerability (CWE-601) that can make your website an accomplice in phishing attacks, damaging user trust and your brand's reputation.</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="card card-hover text-center"><div class="text-3xl mb-3">🎣</div><h3 class="font-semibold text-xl mb-2">Prevent Phishing</h3><p class="text-[var(--text-gray)] dark:text-[var(--dark-text-gray)]">Attackers exploit open redirects to make malicious links look like they come from your trusted domain, tricking users into giving up credentials.</p></div>
            <div class="card card-hover text-center"><div class="text-3xl mb-3">🛡️</div><h3 class="font-semibold text-xl mb-2">Protect Your Users</h3><p class="text-[var(--text-gray)] dark:text-[var(--dark-text-gray)]">By finding and fixing these flaws, you protect your users from being redirected to harmful websites that can steal data or install malware.</p></div>
            <div class="card card-hover text-center"><div class="text-3xl mb-3">✅</div><h3 class="font-semibold text-xl mb-2">Strengthen Security</h3><p class="text-[var(--text-gray)] dark:text-[var(--dark-text-gray)]">Regularly testing for common vulnerabilities like open redirects is a fundamental part of a robust web application security program.</p></div>
        </div>
    </div>
</section>
<section id="faq">
    <div class="container max-w-3xl mx-auto">
        <h2 class="section-title">Open Redirect FAQ</h2>
        <div class="card" id="faq-container">
            <div class="faq-item"><div class="faq-question"><span>What is an Open Redirect vulnerability?</span><svg class="faq-icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7" stroke-linecap="round"/></svg></div><div class="faq-answer"><p>An open redirect occurs when a web application uses user-supplied input to redirect them to another URL without proper validation. An attacker can create a link with your trusted domain that automatically redirects the user to a malicious site. Example: `your-site.com/redirect?url=http://evil-site.com`.</p></div></div>
            <div class="faq-item"><div class="faq-question"><span>How does this tool test for vulnerabilities?</span><svg class="faq-icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7" stroke-linecap="round"/></svg></div><div class="faq-answer"><p>Our tool intelligently parses the URL(s) you provide to find **all** parameters. For each parameter, it generates a list of new URLs with common payloads pointing to a safe, user-defined domain. You can then click these links to safely simulate an attack and see if the redirect occurs.</p></div></div>
            <div class="faq-item"><div class="faq-question"><span>How do I fix an open redirect vulnerability?</span><svg class="faq-icon" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 9l-7 7-7-7" stroke-linecap="round"/></svg></div><div class="faq-answer"><p>The best way is to avoid using user-controlled data in redirect URLs. If you must, implement a strict allow-list of approved, safe domains. Never rely on a block-list, as attackers can often bypass them. Always validate and sanitize all user input that influences redirects.</p></div></div>
        </div>
    </div>
</section>
<footer>
    <div class="container text-center">
        <p>&copy; 2025 Switchere Club. All Rights Reserved.</p>
        <p class="mt-2 text-xs opacity-70">A professional tool for web security testing.</p>
    </div>
</footer>
<script>
    document.getElementById('faq-container').addEventListener('click', function(event) {
        const question = event.target.closest('.faq-question');
        if (question) {
            const answer = question.nextElementSibling;
            const icon = question.querySelector('.faq-icon');
            this.querySelectorAll('.faq-answer.active').forEach(openAnswer => {
                if (openAnswer !== answer) {
                    openAnswer.classList.remove('active');
                    openAnswer.previousElementSibling.querySelector('.faq-icon').classList.remove('active');
                }
            });
            answer.classList.toggle('active'); icon.classList.toggle('active');
        }
    });
</script>
<script type="text/babel">
    const { useState, useEffect, useCallback } = React;

    const ResultItem = ({ result }) => {
        const [isOpen, setIsOpen] = useState(false);

        return (
            <div className="bg-white/50 dark:bg-black/20 rounded-lg">
                <button onClick={() => setIsOpen(!isOpen)} className="w-full flex justify-between items-center p-4 text-left">
                    <span className="font-mono text-sm break-all w-4/5">{result.targetUrl}</span>
                    {result.error ? (
                        <span className="text-xs font-bold text-red-500">Error</span>
                    ) : result.params.length === 0 ? (
                        <span className="text-xs font-bold text-gray-500">No Parameters</span>
                    ) : (
                         <span className="text-xs font-bold text-green-600 dark:text-green-400">{result.totalPayloads} Payloads</span>
                    )}
                    <svg className={`w-5 h-5 flex-shrink-0 transform transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}`} fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7" /></svg>
                </button>
                {isOpen && (
                    <div className="px-4 pb-4 border-t border-gray-200 dark:border-gray-700">
                        {result.error ? (
                            <p className="mt-3 text-sm text-red-600 dark:text-red-400">{result.error}</p>
                        ) : result.params.length === 0 ? (
                             <p className="mt-3 text-sm text-gray-600 dark:text-gray-400">No URL parameters were found to test.</p>
                        ) : (
                            <div className="mt-4">
                                <p className="text-sm mb-3">Testing all found parameters: <span className="font-mono bg-gray-200 dark:bg-gray-700 px-1.5 py-0.5 rounded">{result.params.join(', ')}</span></p>
                                <div className="space-y-4 max-h-80 overflow-y-auto pr-2">
                                    {Object.entries(result.tests).map(([category, payloads]) => (
                                        <div key={category}>
                                            <h4 className="font-bold text-xs uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-2">{category}</h4>
                                            {payloads.map(test => (
                                                <div key={test.id} className="p-2 bg-gray-50 dark:bg-gray-900/50 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 mb-2">
                                                    <div className="w-full sm:w-4/5 break-all">
                                                        <p className="font-mono text-sm">{test.url}</p>
                                                    </div>
                                                    <a href={test.url} target="_blank" rel="noopener noreferrer" className="btn bg-green-500 hover:bg-green-600 text-white px-3 py-1 text-xs w-full sm:w-auto text-center">
                                                        Simulate
                                                    </a>
                                                </div>
                                            ))}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}
                    </div>
                )}
            </div>
        );
    };

    const App = () => {
        const [urlsInput, setUrlsInput] = useState('');
        const [targetUrl, setTargetUrl] = useState('https://evil.com');
        const [results, setResults] = useState(null);
        const [isLoading, setIsLoading] = useState(false);
        const [error, setError] = useState(null);
        const [theme, setTheme] = useState(() => localStorage.getItem('theme') || 'light');

        useEffect(() => { document.documentElement.className = theme; localStorage.setItem('theme', theme); }, [theme]);

        const analyzeUrls = async () => {
            setError(null);
            const urls = urlsInput.split('\n').map(u => u.trim()).filter(Boolean);
            if (urls.length === 0) return;
            
            if (urls.length > 50) {
                setError("You can test a maximum of 50 URLs at a time.");
                return;
            }

            setIsLoading(true);
            setResults(null);

            let payloadList = [];
            try {
                const response = await fetch('https://raw.githubusercontent.com/coffinxp/loxs/main/payloads/or.txt');
                if (!response.ok) throw new Error('Failed to fetch payloads');
                const text = await response.text();
                payloadList = text.split('\n').filter(p => p.trim() !== '');
            } catch (e) {
                setError("Could not fetch the professional payload list. Using a basic set.");
                // Fallback to a smaller, hardcoded list if the fetch fails
                payloadList = ["//example.com", "/example.com", "https://example.com"];
            }

            const analysisResults = urls.map(url => {
                try {
                    const parsedUrl = new URL(url);
                    const redirectParams = Array.from(parsedUrl.searchParams.keys());
                    
                    if (redirectParams.length === 0) {
                        return { targetUrl: url, params: [], tests: {}, totalPayloads: 0 };
                    }
                    
                    const t = targetUrl.replace(/https?:\/\//, '');
                    const finalPayloads = payloadList.map(p => p.replace('evil.com', t));

                    const payloadGroups = {
                        "Comprehensive Payloads": finalPayloads,
                    };
                    
                    const generatedTests = {};
                    let totalPayloads = 0;

                    redirectParams.forEach(param => {
                         for (const category in payloadGroups) {
                            if (!generatedTests[category]) generatedTests[category] = [];
                            payloadGroups[category].forEach(payload => {
                                const testUrl = new URL(parsedUrl);
                                testUrl.searchParams.set(param, payload);
                                generatedTests[category].push({ id: `${url}-${param}-${payload}`, url: testUrl.toString(), payload });
                                totalPayloads++;
                            });
                        }
                    });
                    return { targetUrl: url, params: redirectParams, tests: generatedTests, totalPayloads };
                } catch (e) {
                    return { targetUrl: url, error: "Invalid URL format." };
                }
            });
            
            setResults(analysisResults);
            setIsLoading(false);
        };

        return (
            <div className={`w-full max-w-4xl mx-auto p-4 sm:p-6 md:p-8 rounded-2xl shadow-2xl transition-all duration-500 border backdrop-blur-lg ${theme === 'light' ? 'bg-white/70 border-white/50' : 'bg-gray-800/70 border-gray-700/50'}`}>
                <header className="flex justify-between items-center mb-6"><h2 className="text-xl font-bold text-[var(--primary-dark)] dark:text-white">Bulk Open Redirect Scanner</h2><button onClick={() => setTheme(t => t === 'light' ? 'dark' : 'light')} className={`p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all ${theme === 'light' ? 'bg-gray-200 hover:bg-gray-300 focus:ring-[var(--primary)]' : 'bg-gray-700 hover:bg-gray-600 focus:ring-blue-400'}`}>{theme === 'light' ? '🌙' : '☀️'}</button></header>
                
                <textarea 
                    value={urlsInput}
                    onChange={(e) => setUrlsInput(e.target.value)}
                    placeholder="Enter up to 50 URLs, one per line (e.g., http://testphp.vulnweb.com/listproducts.php?cat=123)"
                    rows="5"
                    className="w-full p-3 text-base rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-900 focus:border-[var(--primary)] focus:ring-2 focus:ring-[var(--primary-light)] dark:focus:ring-blue-900/50 transition-colors font-mono"
                />

                <div className="mt-4">
                    <label htmlFor="targetUrl" className="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">Simulation Target URL</label>
                    <input 
                        id="targetUrl"
                        type="text"
                        value={targetUrl}
                        onChange={(e) => setTargetUrl(e.target.value)}
                        className="w-full sm:w-1/2 p-2 rounded-lg border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-900 focus:border-[var(--primary)] focus:ring-2 focus:ring-[var(--primary-light)] dark:focus:ring-blue-900/50 transition-colors font-mono text-sm"
                    />
                </div>

                <div className="mt-4 flex justify-end items-center gap-4">
                    <p className="text-sm text-gray-500 dark:text-gray-400 mr-auto">
                        {urlsInput.split('\n').map(u => u.trim()).filter(Boolean).length} / 50 URLs
                    </p>
                    <button onClick={() => { setUrlsInput(''); setResults(null); setError(null); }} className="text-sm font-semibold text-gray-600 dark:text-gray-300 hover:underline disabled:opacity-50" disabled={isLoading}>Clear</button>
                    <button onClick={analyzeUrls} className="btn bg-[var(--primary)] hover:bg-[var(--primary-dark)] text-white px-6 py-2 flex items-center justify-center gap-2 disabled:opacity-50" disabled={isLoading}>
                        {isLoading && <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full spinner"></div>}
                        <span>Analyze</span>
                    </button>
                </div>
                {error && <div className="mt-4 p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 rounded-lg text-center font-medium text-sm">{error}</div>}

                {isLoading && <div className="text-center py-12"><div className="w-8 h-8 border-4 border-[var(--primary)] border-t-transparent rounded-full spinner mx-auto"></div><p className="mt-4 font-semibold">Fetching Payloads & Analyzing...</p></div>}
                
                {!isLoading && results && <div className="mt-8 fade-in">
                    <div className="p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg mb-6 text-yellow-800 dark:text-yellow-200">
                        <h3 className="font-bold mb-2 flex items-center gap-2">⚠️ How to Test Safely</h3>
                        <p className="text-sm">Click "Simulate" to open a payload. <strong>If the new tab redirects to `{targetUrl}`, the URL is likely vulnerable.</strong></p>
                    </div>
                    
                    <h3 className="font-bold text-lg mb-3 text-gray-800 dark:text-gray-200">Analysis Results</h3>
                    <div className="space-y-3">
                        {results.map((result, index) => (
                            <ResultItem key={index} result={result} />
                        ))}
                    </div>
                </div>}

            </div>
        );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>

